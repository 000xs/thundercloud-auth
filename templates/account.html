<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>🌩️ Your Storm Kingdom Account</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="emoji-background"></div>
    <nav class="navbar">
        <div class="logo">🌩️</div>
        <div class="nav-links">
            <a href="/">Home</a>
            <a href="/account">Account</a>
            <a href="/logout">Logout</a>
      </div>
    </nav>

    <div class="container">
        <form class="account-form" action="/logout" method="POST">
            <div class="profile-header">
                <div class="profile-picture">
                    <span id="profile-emoji"></span>
                </div>
                <h1 class="username">{{ username }}</h1>
                <span class="score"> 💰 {{ scores }}</span>
            </div>

            <button type="submit" class="cta-btn logout-btn">Logout</button>
        </form>

        <div class="game-container">
            <h2>Weather Emoji Game</h2>
            <p>Click the emoji that matches the weather description!</p>
            <div id="weather-description"></div>
            <div id="emoji-options"></div>
            <div id="game-result"></div>
            <div id="score-container">Score: <span id="score">0</span></div>
        </div>

        <div class="fun-fact-container">
            <h2>Did you know?</h2>
            <p id="fun-fact"></p>
        </div>

        <div class="leaderboard-container">
            <h2>Leaderboard</h2>
            <table>
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Username</th>
                        <th>Scores</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ user[0] }}</td>
                        <td>{{ user[1] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <script>
      const backgroundEmojis = ["🌩️", "🌧️", "🌪️", "🌨️", "☀️", "☁️", "🌥️", "⛅", "🌦️"];
      const background = document.querySelector(".emoji-background");
      for (let i = 0; i < 30; i++) {
        const emoji = document.createElement("div");
        emoji.classList.add("emoji");
        emoji.innerText = backgroundEmojis[Math.floor(Math.random() * backgroundEmojis.length)];
        emoji.style.left = Math.random() * 100 + "vw";
        emoji.style.top = Math.random() * 100 + "vh";
        emoji.style.animationDuration = Math.random() * 5 + 5 + "s";
        background.appendChild(emoji);
      }

      const profileEmojis = ["😀", "😁", "😂", "🤣", "😃", "😄", "😅", "😆", "😉", "😊", "😋", "😎", "🤩", "🥳", "😇", "🥰", "😍", "😘", "😗", "😙", "😚", "☺️", "🙂", "🤗", "🤔", "🤨", "😐", "😑", "😶", "🙄", "😏", "😮", "🤐", "😯", "😪", "😫", "😴", "😌", "😛", "😜", "😝", "🤤", "😒", "😓", "😔", "😕", "🙃", "🤑", "😲", "☹️", "🙁", "😖", "😞", "😟", "😤", "😢", "😭", "😦", "😧", "😨", "😩", "🤯", "😬", "😮‍💨", "😵", "😵‍💫", "🤥", "🤫", "🤭", "🫢", "🫡", "🤓", "🧐", " covert", "🥳", "😎", "🤩", "✨", "💯"];
      const profileEmojiElement = document.getElementById("profile-emoji");
      profileEmojiElement.innerText = profileEmojis[Math.floor(Math.random() * profileEmojis.length)];

      // Weather Emoji Game
      const weatherGame = {
        "Sunny": "☀️",
        "Cloudy": "☁️",
        "Rainy": "🌧️",
        "Stormy": "🌩️",
        "Snowy": "🌨️",
        "Tornado": "🌪️"
      };

      const weatherDescriptionElement = document.getElementById("weather-description");
      const emojiOptionsElement = document.getElementById("emoji-options");
      const gameResultElement = document.getElementById("game-result");

      let correctAnswer;
      let score = 0;

      function startGame() {
        gameResultElement.innerText = "";
        const weatherDescriptions = Object.keys(weatherGame);
        const randomDescription = weatherDescriptions[Math.floor(Math.random() * weatherDescriptions.length)];
        correctAnswer = weatherGame[randomDescription];

        weatherDescriptionElement.innerText = randomDescription;

        const options = [correctAnswer];
        while (options.length < 4) {
          const randomEmoji = backgroundEmojis[Math.floor(Math.random() * backgroundEmojis.length)];
          if (!options.includes(randomEmoji)) {
            options.push(randomEmoji);
          }
        }

        options.sort(() => Math.random() - 0.5);

        emojiOptionsElement.innerHTML = "";
        options.forEach(option => {
          const button = document.createElement("button");
          button.innerText = option;
          button.addEventListener("click", () => checkAnswer(option));
          emojiOptionsElement.appendChild(button);
        });
      }

      function checkAnswer(selectedEmoji) {
        if (selectedEmoji === correctAnswer) {
          gameResultElement.innerText = "Correct! 🎉";
          score++;
          updateScore(score);
        } else {
          gameResultElement.innerText = "Wrong! Try again. 😢";
          score = 0;
          updateScore(score);
        }
        document.getElementById("score").innerText = score;
        setTimeout(startGame, 2000);
      }

      function updateScore(newScore) {
        fetch("/update_score", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ score: newScore }),
        });
      }

      const funFacts = [
        "A bolt of lightning is about 5 times hotter than the surface of the sun.",
        "A tornado can be more than a mile wide and travel at speeds of up to 300 miles per hour.",
        "The most rainfall ever recorded in one year was 25.4 meters (1,000 inches) in Cherrapunji, India.",
        "Snowflakes are not always unique. In 1988, a scientist found two identical snowflakes from a storm in Wisconsin.",
        "The world's largest hailstone weighed over 1 kilogram (2.25 pounds) and was found in Bangladesh in 1986."
      ];
      const funFactElement = document.getElementById("fun-fact");
      funFactElement.innerText = funFacts[Math.floor(Math.random() * funFacts.length)];

      startGame();
    </script>
</body>
</html>
